{% extends "base.html" %}

{% block title %}Task List{% endblock %}

{% block content %}
    <h1 class="index-h1">Python Flask CRUD Application</h1>

    <!-- CREATE Form  -->
    <div class="task-form">
        <h2>Add New Task</h2>
        <form method="POST" action="{{ url_for('index') }}">
            <div class="form-group">
                <label for="title">Title (Required):</label>
                <input type="text" id="title" name="title" required>
            </div>

            <div class="form-group">
                <label for="desc">Description:</label>
                <textarea id="desc" name="desc" rows="2"></textarea> 
            </div>

            <button type="submit" class="add-btn">Add Task</button>
        </form>
    </div>
    
    <!-- READ ALL Section -->
    <h2>Current Tasks</h2>
    <div class="task-list">
        {% if tasks %}
            {% for task in tasks %}
            <div class="task-item">
                <div class="task-details">
                    <strong>{{ task.title }} (ID: {{ task.id }})</strong>
                    <small>{{ task.desc or 'No description provided.' }}</small>
                </div>
                
                <div class="task-actions">
                    <!-- Update Button (Links to the Edit page: READ ONE) -->
                    <a href="{{ url_for('edit', id=task.id) }}" class="button-link edit-btn">Update</a>
                    <!--edit is the endpoint /edit/id and id is passes here -->
                    <!-- Delete Button (Uses a form for POST request for DELETE) -->
                    <form method="POST" action="{{ url_for('delete', id=task.id) }}" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this task?');">
                        <button type="submit" class="delete-btn">Delete</button>
                    </form>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <p>No tasks added yet. Start by adding a new task above!</p>
        {% endif %}
    </div>
{% endblock %}